version: 2 

models:
  - name: keywords
    description: Submissions containing a given keyword (defined in keywords table)

    config:
      contract:
        enforced: true

    constraints:
      - type: primary_key
        columns: ['objectID', 'word']
    
    columns:
      - name: word
        data_type: varchar
        tests:
          - relationships:
              to: source('raw', 'keywords')
              field: keyword 

      - name: objectID
        data_type: varchar

      - name: points
        data_type: int
        tests:
          - dbt_utils.accepted_range:
              min_value: 0 
              inclusive: true
              config:
                severity: warn

      - name: num_comments
        data_type: int
        tests:
          - dbt_utils.accepted_range:
              min_value: 0 
              inclusive: true
          

      - name: submission_date
        data_type: date

      - name: title
        data_type: varchar

      - name: year_month
        data_type: varchar


  - name: hiring_keywords
    description: Comments containing a given keyword (defined in keywords table)
    columns:
      - name: word
        tests: 
          - not_null
          - relationships:
              to: source('raw', 'keywords')
              field: keyword 


  - name: hn_hiring_comments


  - name: submissions_per_day
    description: Number of Hacker News submissions on a given day
    columns:
      - name: submission_date
        description: Submission date
        tests:
          - unique
          - not_null 
          - dbt_utils.accepted_range:
              min_value: "cast('2006-10-09' as date)"
              inclusive: true 

      - name: num_submissions
        description: Number of submissions
        tests:
          - not_null 
          - dbt_utils.accepted_range:
              min_value: 0
              inclusive: true 
        